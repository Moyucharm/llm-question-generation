# Stores çŠ¶æ€ç®¡ç†æ¨¡å—

æœ¬ç›®å½•åŒ…å« QuAIz åº”ç”¨çš„å…¨å±€çŠ¶æ€ç®¡ç†ï¼Œä½¿ç”¨ Zustand å®ç°è½»é‡çº§ã€ç±»å‹å®‰å…¨çš„çŠ¶æ€ç®¡ç†ã€‚

## ğŸ“ ç›®å½•ç»“æ„

```
stores/
â”œâ”€â”€ generation/              # é¢˜ç›®ç”ŸæˆçŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ actions.ts          # ç”Ÿæˆç›¸å…³ Actions
â”‚   â”œâ”€â”€ generators.ts       # é¢˜ç›®ç”Ÿæˆå™¨
â”‚   â”œâ”€â”€ stateManager.ts     # çŠ¶æ€ç®¡ç†å™¨
â”‚   â”œâ”€â”€ types.ts           # ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ index.ts           # æ¨¡å—å¯¼å‡º
â”‚   â””â”€â”€ README.md          # æ¨¡å—æ–‡æ¡£
â”œâ”€â”€ logStore/               # æ—¥å¿—çŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ actions.ts         # æ—¥å¿— Actions
â”‚   â”œâ”€â”€ logger.ts          # æ—¥å¿—è®°å½•å™¨
â”‚   â”œâ”€â”€ types.ts           # ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ utils.ts           # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ index.ts           # æ¨¡å—å¯¼å‡º
â”‚   â””â”€â”€ README.md          # æ¨¡å—æ–‡æ¡£
â”œâ”€â”€ useAppStore.ts          # ä¸»åº”ç”¨çŠ¶æ€ Store
â”œâ”€â”€ useLogStore.ts          # æ—¥å¿—çŠ¶æ€ Store
â”œâ”€â”€ timeRecorderStore.ts    # æ—¶é—´è®°å½•çŠ¶æ€ Store
â”œâ”€â”€ answeringActions.ts     # ç­”é¢˜ç›¸å…³ Actions
â”œâ”€â”€ gradingActions.ts       # æ‰¹æ”¹ç›¸å…³ Actions
â”œâ”€â”€ generationActions.ts    # ç”Ÿæˆ Actions (å…¼å®¹æ€§)
â”œâ”€â”€ mockServices.ts         # æ¨¡æ‹ŸæœåŠ¡
â””â”€â”€ README.md              # æ¨¡å—æ–‡æ¡£
```

## ğŸ¯ æ ¸å¿ƒ Store

### 1. useAppStore - ä¸»åº”ç”¨çŠ¶æ€
- **æ–‡ä»¶**: `./useAppStore.ts`
- **åŠŸèƒ½**: ç®¡ç†é¢˜ç›®ç”Ÿæˆã€ç­”é¢˜å’Œæ‰¹æ”¹çš„å…¨æµç¨‹çŠ¶æ€
- **çŠ¶æ€æ¨¡å—**:
  - `generation`: é¢˜ç›®ç”ŸæˆçŠ¶æ€
  - `answering`: ç­”é¢˜çŠ¶æ€
  - `grading`: æ‰¹æ”¹çŠ¶æ€
- **æ ¸å¿ƒæ–¹æ³•**: `resetApp()` - é‡ç½®æ•´ä¸ªåº”ç”¨çŠ¶æ€

### 2. useLogStore - æ—¥å¿—çŠ¶æ€
- **æ–‡ä»¶**: `./useLogStore.ts`
- **åŠŸèƒ½**: ç®¡ç†å…¨å±€æ—¥å¿—è®°å½•å’Œæ˜¾ç¤º
- **ç‰¹æ€§**:
  - ç³»ç»Ÿæ—¥å¿—è®°å½•
  - æµå¼å›å¤ä¼šè¯ç®¡ç†
  - æ—¥å¿—é¢æ¿å¯è§æ€§æ§åˆ¶
  - è‡ªåŠ¨æ¸…ç†å’Œé™åˆ¶

### 3. useTimeRecorderStore - æ—¶é—´è®°å½•çŠ¶æ€
- **æ–‡ä»¶**: `./timeRecorderStore.ts`
- **åŠŸèƒ½**: ç®¡ç†æ—¶é—´è®°å½•å’Œæ€§èƒ½ç›‘æ§
- **ç‰¹æ€§**:
  - ç²¾ç¡®çš„æ—¶é—´è®°å½•
  - å®æ—¶æ—¶é•¿è®¡ç®—
  - çŠ¶æ€å¯è§†åŒ–
  - ç‹¬ç«‹çŠ¶æ€ç®¡ç†
  - é˜²æŠ–ä¼˜åŒ–

## ğŸ”§ Actions æ¨¡å—

### answeringActions - ç­”é¢˜ Actions
- **æ–‡ä»¶**: `./answeringActions.ts`
- **åŠŸèƒ½**: å¤„ç†ç­”é¢˜è¿‡ç¨‹ä¸­çš„çŠ¶æ€å˜æ›´
- **ä¸»è¦æ–¹æ³•**:
  - `setCurrentQuestionIndex()` - è®¾ç½®å½“å‰é¢˜ç›®ç´¢å¼•
  - `updateUserAnswer()` - æ›´æ–°ç”¨æˆ·ç­”æ¡ˆ
  - `submitQuiz()` - æäº¤è¯•å·
  - `nextQuestion()` / `previousQuestion()` - é¢˜ç›®å¯¼èˆª

### gradingActions - æ‰¹æ”¹ Actions
- **æ–‡ä»¶**: `./gradingActions.ts`
- **åŠŸèƒ½**: å¤„ç†è¯•å·æ‰¹æ”¹ç›¸å…³æ“ä½œ
- **ä¸»è¦æ–¹æ³•**:
  - `startGrading()` - å¼€å§‹æ‰¹æ”¹è¯•å·
  - `setGradingError()` - è®¾ç½®æ‰¹æ”¹é”™è¯¯
  - `resetGrading()` - é‡ç½®æ‰¹æ”¹çŠ¶æ€
- **å·¥å…·å‡½æ•°**: æä¾›å¾—åˆ†è®¡ç®—ã€ç­‰çº§è¯„å®šç­‰è¾…åŠ©åŠŸèƒ½

## ğŸ“Š Generation çŠ¶æ€ç®¡ç†

### æ¨¡å—åŒ–è®¾è®¡
- **actions.ts**: ç”Ÿæˆç›¸å…³çš„ Actions å®šä¹‰
- **generators.ts**: é¢˜ç›®ç”Ÿæˆå™¨å®ç°
- **stateManager.ts**: çŠ¶æ€ç®¡ç†å™¨ç±»
- **types.ts**: ç±»å‹å®šä¹‰

### æ ¸å¿ƒåŠŸèƒ½
- **æµå¼ç”Ÿæˆ**: æ”¯æŒå®æ—¶æ˜¾ç¤ºç”Ÿæˆè¿›åº¦
- **é”™è¯¯å¤„ç†**: å®Œå–„çš„é”™è¯¯çŠ¶æ€ç®¡ç†
- **è¿›åº¦è·Ÿè¸ª**: ç”Ÿæˆè¿›åº¦å’Œå®ŒæˆçŠ¶æ€
- **å¤‡ç”¨æ–¹æ¡ˆ**: LLM ä¸å¯ç”¨æ—¶çš„æ¨¡æ‹ŸæœåŠ¡

### GenerationStateManager ç±»
```typescript
class GenerationStateManager {
  setGenerating(): void          // è®¾ç½®ç”Ÿæˆä¸­çŠ¶æ€
  setError(error: string): void  // è®¾ç½®é”™è¯¯çŠ¶æ€
  updateProgress(progress: number): void  // æ›´æ–°è¿›åº¦
  addStreamingQuestion(question: StreamingQuestion): void  // æ·»åŠ æµå¼é—®é¢˜
  setComplete(quiz: Quiz): void  // è®¾ç½®å®ŒæˆçŠ¶æ€
}
```

## ğŸ“ LogStore æ—¥å¿—ç®¡ç†

### åŠŸèƒ½ç‰¹æ€§
- **å¤šç±»å‹æ—¥å¿—**: æ”¯æŒä¸åŒçº§åˆ«å’Œç±»åˆ«çš„æ—¥å¿—
- **æµå¼ä¼šè¯**: ç®¡ç† AI å¯¹è¯çš„æµå¼å›å¤
- **è‡ªåŠ¨æ¸…ç†**: é˜²æ­¢å†…å­˜æº¢å‡ºçš„è‡ªåŠ¨æ¸…ç†æœºåˆ¶
- **å¯è§†åŒ–**: é…åˆ LogPanel ç»„ä»¶æä¾›å¯è§†åŒ–ç•Œé¢

### æ—¥å¿—ç±»å‹
- **LogEntry**: ç³»ç»Ÿæ—¥å¿—æ¡ç›®
- **StreamSession**: æµå¼å›å¤ä¼šè¯
- **StreamChunk**: æµå¼å›å¤ç‰‡æ®µ

### é…ç½®å‚æ•°
- `MAX_LOGS`: æœ€å¤§æ—¥å¿—æ•°é‡ (10000)
- `MAX_STREAM_SESSIONS`: æœ€å¤§æµå¼ä¼šè¯æ•°é‡ (50)

## ğŸ”„ çŠ¶æ€æµè½¬

### é¢˜ç›®ç”Ÿæˆæµç¨‹
```mermaid
graph TD
    A[idle] --> B[generating]
    B --> C[complete]
    B --> D[error]
    C --> E[answering]
    D --> A
    E --> F[grading]
    F --> G[result]
    G --> A
```

### çŠ¶æ€è¯´æ˜
- **idle**: ç©ºé—²çŠ¶æ€ï¼Œç­‰å¾…ç”¨æˆ·æ“ä½œ
- **generating**: æ­£åœ¨ç”Ÿæˆé¢˜ç›®
- **complete**: ç”Ÿæˆå®Œæˆï¼Œå¯ä»¥å¼€å§‹ç­”é¢˜
- **error**: ç”Ÿæˆå¤±è´¥
- **grading**: æ­£åœ¨æ‰¹æ”¹
- **result**: æ‰¹æ”¹å®Œæˆï¼Œæ˜¾ç¤ºç»“æœ

## ğŸ› ï¸ å·¥å…·å’ŒæœåŠ¡

### mockServices - æ¨¡æ‹ŸæœåŠ¡
- **æ–‡ä»¶**: `./mockServices.ts`
- **åŠŸèƒ½**: LLM é…ç½®ä¸å®Œæ•´æ—¶çš„å¤‡ç”¨æ–¹æ¡ˆ
- **ç‰¹æ€§**:
  - æ¨¡æ‹Ÿé¢˜ç›®ç”Ÿæˆ
  - æ¨¡æ‹Ÿæ‰¹æ”¹æœåŠ¡
  - æ”¯æŒæ‰€æœ‰é¢˜å‹
  - ç½‘ç»œå»¶è¿Ÿæ¨¡æ‹Ÿ

### é¢˜ç›®ç”Ÿæˆå™¨æ˜ å°„
```typescript
const questionGenerators = {
  'single-choice': createSingleChoiceQuestion,
  'multiple-choice': createMultipleChoiceQuestion,
  'fill-blank': createFillBlankQuestion,
  'short-answer': createShortAnswerQuestion,
  'code-output': createCodeOutputQuestion,
  'code-writing': createCodeWritingQuestion
};
```

## ğŸ¨ è®¾è®¡ç‰¹ç‚¹

- **æ¨¡å—åŒ–**: æŒ‰åŠŸèƒ½æ¨¡å—ç»„ç»‡ï¼Œä¾¿äºç»´æŠ¤å’Œæ‰©å±•
- **ç±»å‹å®‰å…¨**: å®Œæ•´çš„ TypeScript ç±»å‹å®šä¹‰
- **å“åº”å¼**: åŸºäº Zustand çš„å“åº”å¼çŠ¶æ€ç®¡ç†
- **å¯æµ‹è¯•**: çº¯å‡½æ•°è®¾è®¡ï¼Œä¾¿äºå•å…ƒæµ‹è¯•
- **å¯æ‰©å±•**: æ”¯æŒæ’ä»¶å¼æ‰©å±•æ–°åŠŸèƒ½

## ğŸ”— ç›¸å…³æ¨¡å—

- **é¡µé¢ç»„ä»¶**: `../pages/` - ä½¿ç”¨çŠ¶æ€çš„é¡µé¢ç»„ä»¶
- **UI ç»„ä»¶**: `../components/` - å±•ç¤ºçŠ¶æ€çš„ UI ç»„ä»¶
- **LLM æœåŠ¡**: `../llm/` - å®é™…çš„ AI æœåŠ¡è°ƒç”¨
- **ç±»å‹å®šä¹‰**: `../types/` - å…±äº«çš„ç±»å‹å®šä¹‰

## ğŸ‘¨â€ğŸ’» å¼€å‘è€…

- **ä½œè€…**: JacksonHe04
- **é¡¹ç›®**: QuAIz - AI æ™ºèƒ½åˆ·é¢˜ç³»ç»Ÿ
- **æ¶æ„**: åŸºäº Zustand çš„æ¨¡å—åŒ–çŠ¶æ€ç®¡ç†